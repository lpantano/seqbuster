<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{An Introduction to the IsomiR package}
-->

Example of isomiRs function 

========================================================

We are going to use a small RNAseq data coming from human frontal cortex samples. There are two groups: b) individuals with less than a year, o) individuals in the eldery.


```{r}
library(isomiRs)
data(isomiRex)
```

You can plot isomiRs tendencies with `plotIso`

```{r fig.width=7, fig.height=6}
#check plot iso
obj<-plotIso(obj,type="t5")
```

Do differential expression analysis using DESeq

```{r}
dds<-deIso(obj,formula=~condition,ref=T,iso5=T)
#plotMA
library(DESeq2)
plotMA(dds)
head(counts(dds))
```

Let's do a PLS model having in the count matrix the reference miRNA, and all isomiRs for each miRNA.

```{r}
obj<-makeCounts(obj,ref=T)
obj<-normIso(obj)
pls.obj<-isoPLSDA(obj,"condition")
isoPLSDAplot(pls.obj$component,obj@design[,"condition"])
```

You can do the analysis just with features that are important for the model

```{r}
pls.obj<-isoPLSDA(obj,"condition",refinment=TRUE)
```
